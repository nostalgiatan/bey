# BEY åˆ†å¸ƒå¼åŠŸèƒ½æ¨¡å— (bey-func)

BEY åˆ†å¸ƒå¼åŠŸèƒ½æ¨¡å—æä¾›äº†é›†æˆç½‘ç»œã€å­˜å‚¨ã€æ¶ˆæ¯å’Œå‰ªåˆ‡æ¿çš„é«˜çº§APIï¼ŒåŸºäº Token å…ƒç±»å’Œæ¥æ”¶å™¨æ¨¡å—å®ç°åˆ†å¸ƒå¼æœåŠ¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½

1. **æ¶ˆæ¯ç³»ç»Ÿ** (`message_func`)
   - ç§ä¿¡ï¼ˆç‚¹å¯¹ç‚¹ï¼‰
   - ç¾¤èŠæ¶ˆæ¯
   - å¹¿æ’­æ¶ˆæ¯
   - åŸºäº Token çš„æ¶ˆæ¯è·¯ç”±

2. **å‰ªåˆ‡æ¿åŒæ­¥** (`clipboard_func`)
   - æ·»åŠ /åˆ é™¤å‰ªåˆ‡æ¿å†…å®¹
   - å·®å¼‚åŒæ­¥
   - ç¾¤ç»„åŒæ­¥
   - ç‚¹å¯¹ç‚¹åŒæ­¥
   - æ ‡è®°æ¥æºè®¾å¤‡ DNS ID

3. **å­˜å‚¨åŠŸèƒ½** (`storage_func`)
   - äº‘å­˜å‚¨ä¸Šä¼ /ä¸‹è½½
   - ç‚¹å¯¹ç‚¹æ–‡ä»¶ä¼ è¾“
   - å¤§æ–‡ä»¶æµå¼ä¼ è¾“
   - äº‘å­˜å‚¨æ›´æ–°é€šçŸ¥

### ğŸ“ æ¶æ„è®¾è®¡

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEY åˆ†å¸ƒå¼åŠŸèƒ½å±‚                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ¶ˆæ¯åŠŸèƒ½      â”‚  â”‚ å‰ªåˆ‡æ¿åŠŸèƒ½    â”‚  â”‚ å­˜å‚¨åŠŸèƒ½      â”‚  â”‚
â”‚  â”‚ MessageFunc  â”‚  â”‚ ClipboardFuncâ”‚  â”‚ StorageFunc  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â†“                 â†“                 â†“           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         BeyFuncManager (ç»Ÿä¸€ç®¡ç†å™¨)                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BEY ç½‘ç»œå±‚ (bey-net)                         â”‚
â”‚  - Token æ¥æ”¶å™¨å’Œè·¯ç”±                                     â”‚
â”‚  - TransportEngine (å‘é€/æ¥æ”¶)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BEY å­˜å‚¨å±‚ (bey-storage)                     â”‚
â”‚  - å¯¹è±¡å­˜å‚¨ã€äº‘å­˜å‚¨                                        â”‚
â”‚  - å‰ªåˆ‡æ¿ã€æ¶ˆæ¯æŒä¹…åŒ–                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### åˆ›å»ºç®¡ç†å™¨

```rust
use bey_func::BeyFuncManager;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    // åˆ›å»ºåˆ†å¸ƒå¼åŠŸèƒ½ç®¡ç†å™¨
    let manager = BeyFuncManager::new("my_device", "./storage").await?;

    // å¯åŠ¨ç½‘ç»œæœåŠ¡ï¼ˆè‡ªåŠ¨æ³¨å†Œæ‰€æœ‰å¤„ç†å™¨ï¼‰
    manager.start().await?;

    Ok(())
}
```

### æ¶ˆæ¯åŠŸèƒ½

```rust
// å‘é€ç§ä¿¡
let msg_id = manager.send_private_message("peer_device", b"Hello!").await?;

// å‘é€ç¾¤èŠæ¶ˆæ¯
let msg_id = manager.send_group_message("group1", b"Hi everyone!").await?;

// å¹¿æ’­æ¶ˆæ¯
let count = manager.broadcast_message(b"Important announcement").await?;
```

### å‰ªåˆ‡æ¿åŒæ­¥

```rust
// æ·»åŠ å‰ªåˆ‡æ¿å†…å®¹
let entry_id = manager.add_clipboard("text", b"clipboard content").await?;

// åŒæ­¥åˆ°å¯¹ç­‰è®¾å¤‡
manager.sync_clipboard_to_peer("peer_device").await?;

// åŒæ­¥åˆ°ç¾¤ç»„
manager.sync_clipboard_to_group("group1").await?;

// å‘é€å·®å¼‚æ›´æ–°
manager.clipboard.send_diff_to_peer("peer_device", timestamp).await?;
```

### å­˜å‚¨åŠŸèƒ½

```rust
// ä¸Šä¼ åˆ°äº‘å­˜å‚¨
let file_hash = manager.upload_to_cloud("document.txt", &data).await?;

// ä»äº‘å­˜å‚¨ä¸‹è½½
let data = manager.download_from_cloud(&file_hash).await?;

// å‘é€æ–‡ä»¶åˆ°å¯¹ç­‰è®¾å¤‡
manager.send_file_to_peer("peer_device", "file.txt", &data).await?;

// å‘é€å¤§æ–‡ä»¶
let stream_id = manager.storage_func
    .send_large_file_to_peer("peer_device", "large.bin", &data).await?;
```

## Token ç±»å‹

### æ¶ˆæ¯ä»¤ç‰Œ

- `bey.message.private` - ç§ä¿¡
- `bey.message.group` - ç¾¤èŠ
- `bey.message.broadcast` - å¹¿æ’­

### å‰ªåˆ‡æ¿ä»¤ç‰Œ

- `bey.clipboard.add` - æ·»åŠ æ¡ç›®
- `bey.clipboard.delete` - åˆ é™¤æ¡ç›®
- `bey.clipboard.sync` - å®Œæ•´åŒæ­¥
- `bey.clipboard.diff` - å·®å¼‚åŒæ­¥

### å­˜å‚¨ä»¤ç‰Œ

- `bey.storage.file` - æ–‡ä»¶ä¼ è¾“
- `bey.storage.cloud.upload` - äº‘å­˜å‚¨ä¸Šä¼ 
- `bey.storage.cloud.download` - äº‘å­˜å‚¨ä¸‹è½½
- `bey.storage.cloud.notify` - äº‘å­˜å‚¨é€šçŸ¥

## è‡ªåŠ¨å¤„ç†

æ‰€æœ‰ Token ç±»å‹éƒ½ä¼šè‡ªåŠ¨æ³¨å†Œå¤„ç†å™¨ï¼Œå½“æ¥æ”¶åˆ°ç›¸åº”çš„ä»¤ç‰Œæ—¶ï¼š

1. **æ¶ˆæ¯æ¥æ”¶** - è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ¶ˆæ¯æ•°æ®åº“
2. **å‰ªåˆ‡æ¿åŒæ­¥** - è‡ªåŠ¨åˆå¹¶åˆ°æœ¬åœ°å‰ªåˆ‡æ¿
3. **æ–‡ä»¶æ¥æ”¶** - è‡ªåŠ¨ä¿å­˜åˆ°å¯¹è±¡å­˜å‚¨
4. **äº‘å­˜å‚¨é€šçŸ¥** - è‡ªåŠ¨è®°å½•æ›´æ–°ä¿¡æ¯

## API æ–‡æ¡£

å®Œæ•´çš„ API æ–‡æ¡£å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š

```bash
cargo doc --package bey-func --open
```

## ä¾èµ–å…³ç³»

- `bey-net` - ç½‘ç»œä¼ è¾“å’Œ Token è·¯ç”±
- `bey-storage` - æ•°æ®æŒä¹…åŒ–
- `error` - é”™è¯¯å¤„ç†
- `tokio` - å¼‚æ­¥è¿è¡Œæ—¶
- `serde` - åºåˆ—åŒ–/ååºåˆ—åŒ–

## è®¾è®¡åŸåˆ™

1. **é«˜çº§æŠ½è±¡** - æä¾›ç®€å•æ˜“ç”¨çš„é«˜çº§ API
2. **è‡ªåŠ¨åŒ–** - è‡ªåŠ¨æ³¨å†Œå¤„ç†å™¨å’Œè·¯ç”±
3. **åˆ†å¸ƒå¼** - æ‰€æœ‰åŠŸèƒ½éƒ½æ”¯æŒåˆ†å¸ƒå¼åœºæ™¯
4. **ç±»å‹å®‰å…¨** - ä½¿ç”¨ Token å…ƒç±»ç¡®ä¿ç±»å‹å®‰å…¨
5. **æ€§èƒ½ä¼˜åŒ–** - æ—  unwrap()ï¼Œé”™è¯¯å¤„ç†å®Œå–„

## ç¤ºä¾‹ç¨‹åº

æŸ¥çœ‹ `examples/` ç›®å½•è·å–æ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚

## æµ‹è¯•

è¿è¡Œå•å…ƒæµ‹è¯•ï¼š

```bash
cargo test --package bey-func
```

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªé¡¹ç›®çš„ä»£ç è§„èŒƒï¼š

1. ä½¿ç”¨ä¸­æ–‡æ³¨é‡Šå’Œæ–‡æ¡£
2. éµå¾ªæµ‹è¯•é©±åŠ¨åŸåˆ™
3. ç¦æ­¢ä½¿ç”¨ unwrap()
4. ä½¿ç”¨ error æ¨¡å—å¤„ç†é”™è¯¯

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªé¡¹ç›®æ ¹ç›®å½•çš„è®¸å¯è¯ã€‚
